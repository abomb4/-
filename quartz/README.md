# 研究 Quartz 用法
目标是做一个调度平台，用一套分布式应用统一管理定时任务的调度，基于 Quartz 开发。

调度平台实现 Spring Cloud 微服务调用。

参考了教程 https://www.baeldung.com/spring-quartz-schedule 。

## 简介
Quartz 有四个基础概念：
- Job：任务具体执行的代码
- JobDetail：任务信息，定义信息
- Trigger ：触发器，描述任务触发规则
- Scheduler：Quartz 的主 API

## 目的
功能包括：
- 每天每间隔几分钟就执行一次某任务
- 每天定点执行批量操作
- 可以在定时任务界面手工触发一次批量操作
- 可以停用、启用
- 可以改 Cron 表达式
- 失败了要支持自动和手工重试（当然批量处理业务要实现幂等性，相同参数的调用，返回值要相同，业务不能重复处理）
    - 失败重试要考虑日期类动态参数的问题，否则跨日就不能执行了
- 记录处理时间、处理结果、发起类型

系统功能包括：
- 基于 Ribbon 负载均衡调用注册中心微服务
- 要支持【动态参数】
    - 当前日期、当前日期的前 n 天、当前日期的后 n 天
    - 当前时间
- 要支持【动态参数】的手工执行的配置


## 研究
按理解，定时任务分为两类：
- 固定任务
- 动态任务

固定任务就是只存在一个同名 job 和 trigger 的任务；
动态任务就是一类任务允许有多个 JobDetail 和 Trigger 的。

大部分任务应该都是固定任务，动态任务应该没这种需求。

例如我们有一个日终批量功能，每天晚上 9 点开始进行批量处理。
此时系统中应该定义一个固定的任务叫做“日终批量”。



